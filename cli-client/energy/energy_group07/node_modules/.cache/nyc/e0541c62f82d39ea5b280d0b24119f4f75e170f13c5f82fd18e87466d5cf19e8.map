{"version":3,"file":"/home/vangelis/TL19-07/cli-client/energy/energy_group07/src/commands/Admin.ts","sources":["/home/vangelis/TL19-07/cli-client/energy/energy_group07/src/commands/Admin.ts"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst cli_ux_1 = require(\"cli-ux\");\n// just prompt for input\nconst command_1 = require(\"@oclif/command\");\nconst command_2 = require(\"@oclif/command\");\nconst bcrypt = require('bcrypt');\nvar fs = require('fs');\nconst https = require('https');\nconst axios = require('axios');\nconst client_cert = fs.readFileSync('ca-crt.pem');\naxios.defaults.httpsAgent = new https.Agent({ ca: client_cert, keepAlive: true });\nclass AdminCommand extends command_1.Command {\n    async run() {\n        const { flags } = this.parse(AdminCommand);\n        var fs = require('fs');\n        var jwt = require('jsonwebtoken');\n        var token = fs.readFileSync('softeng19bAPI.token', 'utf-8');\n        axios.defaults.headers.common['X-OBSERVATORY-AUTH'] = token;\n        await cli_ux_1.default.anykey();\n        //create new user\n        if (`${flags.newuser}` !== \"undefined\" && `${flags.passw}` !== \"undefined\" && `${flags.email}` !== \"undefined\" && `${flags.quota}` !== \"undefined\") {\n            let hash = bcrypt.hashSync(`${flags.passw}`, 10);\n            let body = new Object({\n                username: `${flags.newuser}`,\n                passw: `${flags.passw}`,\n                email: `${flags.email}`,\n                quota: `${flags.quota}`\n            });\n            await axios.post('https://localhost:8765/energy/api/Admin/users', body);\n            console.log(\"User inserted succesfully\");\n        }\n        //modify user\n        else if (`${flags.moduser}` !== \"undefined\" && `${flags.passw}` !== \"undefined\" && `${flags.email}` !== \"undefined\" && `${flags.quota}` !== \"undefined\") {\n            let body = new Object({\n                username: `${flags.moduser}`,\n                passw: `${flags.passw}`,\n                email: `${flags.email}`,\n                quota: `${flags.quota}`\n            });\n            await axios.put('https://localhost:8765/energy/api/Admin/users/' + `${flags.moduser}`, body);\n            console.log('User modified succesfully');\n        }\n        //get userstatus\n        else if (`${flags.userstatus}` !== \"undefined\") {\n            const data = await axios.get('https://localhost:8765/energy/api/Admin/users/' + `${flags.userstatus}`);\n            console.log(data.data);\n        }\n        //insert new data\n        else if (`${flags.newdata}` !== \"undefined\" && `${flags.source}` !== \"undefined\") {\n            var csv = require('csv-parser');\n            var FormData = require('form-data');\n            const form_data = new FormData();\n            var data = [];\n            form_data.append(\"file\", fs.createReadStream(`${flags.source}`));\n            form_data.pipe(csv()).on('data', function (row) { data.push(row); }).on('end', function () { console.log('Data Loaded'); });\n            let header = form_data.getHeaders();\n            const config = {\n                method: 'POST',\n                port: 8765,\n                headers: {\n                    \"x-observatory-auth\": token,\n                    header\n                },\n                maxContentLength: 524228890\n            };\n            return await axios.post('https://localhost:8765/energy/api/Admin/' + `${flags.newdata}`, form_data, config);\n        }\n        else\n            console.log(\"Unsuccesful\" + `${flags.newuser}`, `${flags.passw}`, `${flags.email}`, `${flags.quota}`);\n    }\n}\nexports.AdminCommand = AdminCommand;\nAdminCommand.flags = {\n    newuser: command_2.flags.string({ dependsOn: ['passw'], exclusive: ['newdata', 'userstatus', 'moduser'] }),\n    moduser: command_2.flags.string({ dependsOn: ['passw'], exclusive: ['newuser', 'newdata', 'userstatus'] }),\n    passw: command_2.flags.string({ dependsOn: ['email'] }),\n    email: command_2.flags.string({ dependsOn: ['quota'] }),\n    quota: command_2.flags.string(),\n    userstatus: command_2.flags.string({ exclusive: ['newdata', 'newuser', 'moduser'] }),\n    newdata: command_2.flags.string({ dependsOn: ['source'], exclusive: ['userstatus', 'newuser', 'moduser'] }),\n    source: command_2.flags.string()\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvdmFuZ2VsaXMvVEwxOS0wNy9jbGktY2xpZW50L2VuZXJneS9lbmVyZ3lfZ3JvdXAwNy9zcmMvY29tbWFuZHMvQWRtaW4udHMiLCJzb3VyY2VzIjpbIi9ob21lL3ZhbmdlbGlzL1RMMTktMDcvY2xpLWNsaWVudC9lbmVyZ3kvZW5lcmd5X2dyb3VwMDcvc3JjL2NvbW1hbmRzL0FkbWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQXdCO0FBQ3hCLHdCQUF3QjtBQUN4Qiw0Q0FBc0M7QUFFdEMsNENBQXFDO0FBQ3JDLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNqQyxJQUFJLEVBQUUsR0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDckIsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0FBQzlCLE1BQU0sS0FBSyxHQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUM3QixNQUFNLFdBQVcsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFBO0FBQ2pELEtBQUssQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFDLEVBQUUsRUFBRyxXQUFXLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUE7QUFDaEYsTUFBYSxZQUFhLFNBQVEsaUJBQU87SUFXdkMsS0FBSyxDQUFDLEdBQUc7UUFDUCxNQUFNLEVBQUMsS0FBSyxFQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUM1QyxJQUFJLEVBQUUsR0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckIsSUFBSSxHQUFHLEdBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ2hDLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMscUJBQXFCLEVBQUMsT0FBTyxDQUFDLENBQUM7UUFD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QyxFQUFDLFNBQVMsRUFBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLFNBQVMsRUFBQyxDQUFDLFNBQVMsRUFBQyxTQUFTLEVBQUMsWUFBWSxDQUFDLEVBQUMsQ0FBQztJQUN6RixLQUFLLEVBQUUsZUFBSyxDQUFDLE1BQU0sQ0FBQyxFQUFDLFNBQVMsRUFBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLENBQUM7SUFDMUMsS0FBSyxFQUFFLGVBQUssQ0FBQyxNQUFNLENBQUMsRUFBQyxTQUFTLEVBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxDQUFDO0lBQzFDLEtBQUssRUFBRSxlQUFLLENBQUMsTUFBTSxFQUFFO0lBQ3JCLFVBQVUsRUFBRSxlQUFLLENBQUMsTUFBTSxDQUFDLEVBQUMsU0FBUyxFQUFDLENBQUMsU0FBUyxFQUFDLFNBQVMsRUFBQyxTQUFTLENBQUMsRUFBQyxDQUFDO0lBQ3JFLE9BQU8sRUFBRSxlQUFLLENBQUMsTUFBTSxDQUFDLEVBQUMsU0FBUyxFQUFDLENBQUMsUUFBUSxDQUFDLEVBQUMsU0FBUyxFQUFDLENBQUMsWUFBWSxFQUFDLFNBQVMsRUFBQyxTQUFTLENBQUMsRUFBQyxDQUFDO0lBQzFGLE1BQU0sRUFBRSxlQUFLLENBQUMsTUFBTSxFQUFFO0NBQ3ZCLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY2xpIGZyb20gJ2NsaS11eCdcbi8vIGp1c3QgcHJvbXB0IGZvciBpbnB1dFxuaW1wb3J0IHtDb21tYW5kfSBmcm9tICdAb2NsaWYvY29tbWFuZCdcbmltcG9ydCB7Y3JlYXRlQ29ubmVjdGlvbn0gZnJvbSBcInR5cGVvcm1cIjtcbmltcG9ydCB7ZmxhZ3N9IGZyb20gICdAb2NsaWYvY29tbWFuZCdcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpO1xudmFyIGZzPXJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBodHRwcyA9IHJlcXVpcmUoJ2h0dHBzJylcbmNvbnN0IGF4aW9zPXJlcXVpcmUoJ2F4aW9zJyk7XG5jb25zdCBjbGllbnRfY2VydCA9IGZzLnJlYWRGaWxlU3luYygnY2EtY3J0LnBlbScpXG5heGlvcy5kZWZhdWx0cy5odHRwc0FnZW50ID0gbmV3IGh0dHBzLkFnZW50KHtjYSA6IGNsaWVudF9jZXJ0LCBrZWVwQWxpdmU6IHRydWV9KVxuZXhwb3J0IGNsYXNzIEFkbWluQ29tbWFuZCBleHRlbmRzIENvbW1hbmQge1xuICBzdGF0aWMgZmxhZ3MgPSB7IFxuICAgIG5ld3VzZXI6IGZsYWdzLnN0cmluZyh7ZGVwZW5kc09uOlsncGFzc3cnXSxleGNsdXNpdmU6WyduZXdkYXRhJywndXNlcnN0YXR1cycsJ21vZHVzZXInXX0pLFxuICAgIG1vZHVzZXI6IGZsYWdzLnN0cmluZyh7ZGVwZW5kc09uOlsncGFzc3cnXSxleGNsdXNpdmU6WyduZXd1c2VyJywnbmV3ZGF0YScsJ3VzZXJzdGF0dXMnXX0pLFxuICAgIHBhc3N3OiBmbGFncy5zdHJpbmcoe2RlcGVuZHNPbjpbJ2VtYWlsJ119KSxcbiAgICBlbWFpbDogZmxhZ3Muc3RyaW5nKHtkZXBlbmRzT246WydxdW90YSddfSksXG4gICAgcXVvdGE6IGZsYWdzLnN0cmluZygpLFxuICAgIHVzZXJzdGF0dXM6IGZsYWdzLnN0cmluZyh7ZXhjbHVzaXZlOlsnbmV3ZGF0YScsJ25ld3VzZXInLCdtb2R1c2VyJ119KSxcbiAgICBuZXdkYXRhOiBmbGFncy5zdHJpbmcoe2RlcGVuZHNPbjpbJ3NvdXJjZSddLGV4Y2x1c2l2ZTpbJ3VzZXJzdGF0dXMnLCduZXd1c2VyJywnbW9kdXNlciddfSksXG4gICAgc291cmNlOiBmbGFncy5zdHJpbmcoKVxuICB9XG4gIGFzeW5jIHJ1bigpIHtcbiAgICBjb25zdCB7ZmxhZ3N9ID0gdGhpcy5wYXJzZShBZG1pbkNvbW1hbmQpOyBcblx0dmFyIGZzPXJlcXVpcmUoJ2ZzJyk7XG5cdHZhciBqd3Q9cmVxdWlyZSgnanNvbndlYnRva2VuJyk7XG5cdHZhciB0b2tlbiA9IGZzLnJlYWRGaWxlU3luYygnc29mdGVuZzE5YkFQSS50b2tlbicsJ3V0Zi04Jyk7XG5cdGF4aW9zLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLU9CU0VSVkFUT1JZLUFVVEgnXT10b2tlbjtcblx0YXdhaXQgY2xpLmFueWtleSgpO1xuXHQvL2NyZWF0ZSBuZXcgdXNlclxuXHRpZiAoYCR7ZmxhZ3MubmV3dXNlcn1gICE9PSBcInVuZGVmaW5lZFwiICYmIGAke2ZsYWdzLnBhc3N3fWAgIT09IFwidW5kZWZpbmVkXCIgJiYgYCR7ZmxhZ3MuZW1haWx9YCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBgJHtmbGFncy5xdW90YX1gICE9PSBcInVuZGVmaW5lZFwiICl7XG5cdFx0XHRsZXQgaGFzaCA9IGJjcnlwdC5oYXNoU3luYyhgJHtmbGFncy5wYXNzd31gLDEwKTtcblx0XHRcdGxldCBib2R5ID0gbmV3IE9iamVjdCAoe1xuXHRcdFx0XHR1c2VybmFtZTogYCR7ZmxhZ3MubmV3dXNlcn1gLFxuXHRcdFx0XHRwYXNzdzogYCR7ZmxhZ3MucGFzc3d9YCxcblx0XHRcdFx0ZW1haWw6IGAke2ZsYWdzLmVtYWlsfWAsXG5cdFx0XHRcdHF1b3RhOiBgJHtmbGFncy5xdW90YX1gIFxuXHRcdFx0fSlcblx0XHRcdGF3YWl0IGF4aW9zLnBvc3QoJ2h0dHBzOi8vbG9jYWxob3N0Ojg3NjUvZW5lcmd5L2FwaS9BZG1pbi91c2VycycsYm9keSk7XG5cdFx0XHRjb25zb2xlLmxvZyhcIlVzZXIgaW5zZXJ0ZWQgc3VjY2VzZnVsbHlcIik7XG5cdFx0XHRcdFxuXHR9XG5cdFxuXHQvL21vZGlmeSB1c2VyXG5cdGVsc2UgaWYgKGAke2ZsYWdzLm1vZHVzZXJ9YCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBgJHtmbGFncy5wYXNzd31gICE9PSBcInVuZGVmaW5lZFwiICYmIGAke2ZsYWdzLmVtYWlsfWAgIT09IFwidW5kZWZpbmVkXCIgJiYgYCR7ZmxhZ3MucXVvdGF9YCAhPT0gXCJ1bmRlZmluZWRcIiApe1xuXHRcdGxldCBib2R5ID0gbmV3IE9iamVjdCAoe1xuXHRcdFx0XHR1c2VybmFtZTogYCR7ZmxhZ3MubW9kdXNlcn1gLFxuXHRcdFx0XHRwYXNzdzogYCR7ZmxhZ3MucGFzc3d9YCxcblx0XHRcdFx0ZW1haWw6IGAke2ZsYWdzLmVtYWlsfWAsXG5cdFx0XHRcdHF1b3RhOiBgJHtmbGFncy5xdW90YX1gIFxuXHRcdH0pXG5cdFx0YXdhaXQgYXhpb3MucHV0KCdodHRwczovL2xvY2FsaG9zdDo4NzY1L2VuZXJneS9hcGkvQWRtaW4vdXNlcnMvJyArYCR7ZmxhZ3MubW9kdXNlcn1gLGJvZHkpO1xuXHRcdGNvbnNvbGUubG9nKCdVc2VyIG1vZGlmaWVkIHN1Y2Nlc2Z1bGx5Jyk7XG5cdH1cblx0XG5cdFxuXHQvL2dldCB1c2Vyc3RhdHVzXG5cdGVsc2UgaWYgKGAke2ZsYWdzLnVzZXJzdGF0dXN9YCAhPT0gXCJ1bmRlZmluZWRcIil7XG5cdFx0Y29uc3QgZGF0YT1hd2FpdCBheGlvcy5nZXQoJ2h0dHBzOi8vbG9jYWxob3N0Ojg3NjUvZW5lcmd5L2FwaS9BZG1pbi91c2Vycy8nICtgJHtmbGFncy51c2Vyc3RhdHVzfWApO1x0XG5cdFx0Y29uc29sZS5sb2coZGF0YS5kYXRhKTtcblx0fVxuXG5cdFxuXHQvL2luc2VydCBuZXcgZGF0YVxuXHRlbHNlIGlmIChgJHtmbGFncy5uZXdkYXRhfWAgIT09IFwidW5kZWZpbmVkXCIgJiYgYCR7ZmxhZ3Muc291cmNlfWAgIT09IFwidW5kZWZpbmVkXCIgKXtcblx0XHR2YXIgY3N2PXJlcXVpcmUoJ2Nzdi1wYXJzZXInKTtcblx0XHR2YXIgRm9ybURhdGE9cmVxdWlyZSgnZm9ybS1kYXRhJyk7XG5cdFx0Y29uc3QgZm9ybV9kYXRhID0gbmV3IEZvcm1EYXRhKCk7XG5cdFx0dmFyIGRhdGEgPSBbXTtcblx0XHRmb3JtX2RhdGEuYXBwZW5kKFwiZmlsZVwiLCBmcy5jcmVhdGVSZWFkU3RyZWFtKGAke2ZsYWdzLnNvdXJjZX1gKSk7XG5cdFx0Zm9ybV9kYXRhLnBpcGUoY3N2KCkpLm9uKCdkYXRhJyxmdW5jdGlvbihyb3c6YW55KXsgZGF0YS5wdXNoKHJvdykgfSkub24oJ2VuZCcsZnVuY3Rpb24oKXtjb25zb2xlLmxvZygnRGF0YSBMb2FkZWQnKX0pO1xuXHRcdGxldCBoZWFkZXIgPSBmb3JtX2RhdGEuZ2V0SGVhZGVycygpO1xuXHRcdGNvbnN0IGNvbmZpZyA9IHtcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0cG9ydDo4NzY1LFxuXHRcdFx0aGVhZGVyczoge1xuXHRcdFx0XHRcIngtb2JzZXJ2YXRvcnktYXV0aFwiOnRva2VuLFxuXHRcdFx0XHRoZWFkZXJcblx0XHRcdH0sXG4gXHRcdFx0bWF4Q29udGVudExlbmd0aDo1MjQyMjg4OTBcblx0XHR9O1xuXG5cdFx0cmV0dXJuIGF3YWl0IGF4aW9zLnBvc3QoJ2h0dHBzOi8vbG9jYWxob3N0Ojg3NjUvZW5lcmd5L2FwaS9BZG1pbi8nICsgYCR7ZmxhZ3MubmV3ZGF0YX1gLCBmb3JtX2RhdGEsY29uZmlnKTtcblx0fVxuXHRlbHNlIGNvbnNvbGUubG9nKFwiVW5zdWNjZXNmdWxcIiArIGAke2ZsYWdzLm5ld3VzZXJ9YCxgJHtmbGFncy5wYXNzd31gLGAke2ZsYWdzLmVtYWlsfWAsYCR7ZmxhZ3MucXVvdGF9YCk7ICBcbiAgfVxufVxuXG5cblxuXG5cblxuIl19"]}