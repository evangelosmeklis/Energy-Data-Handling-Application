{"version":3,"file":"/home/vangelis/TL19-07/cli-client/energy/energy_group07/src/commands/Admin.ts","sources":["/home/vangelis/TL19-07/cli-client/energy/energy_group07/src/commands/Admin.ts"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst cli_ux_1 = require(\"cli-ux\");\n// just prompt for input\nconst command_1 = require(\"@oclif/command\");\nconst command_2 = require(\"@oclif/command\");\nconst bcrypt = require('bcrypt');\nvar fs = require('fs');\nconst https = require('https');\nconst axios = require('axios');\nconst client_cert = fs.readFileSync('ca-crt.pem');\naxios.defaults.httpsAgent = new https.Agent({ ca: client_cert, keepAlive: true });\nclass AdminCommand extends command_1.Command {\n    async run() {\n        const { flags } = this.parse(AdminCommand);\n        var fs = require('fs');\n        var jwt = require('jsonwebtoken');\n        var token = fs.readFileSync('softeng19bAPI.token', 'utf-8');\n        axios.defaults.headers.common['X-OBSERVATORY-AUTH'] = token;\n        await cli_ux_1.default.anykey();\n        //create new user\n        if (`${flags.newuser}` !== \"undefined\" && `${flags.passw}` !== \"undefined\" && `${flags.email}` !== \"undefined\" && `${flags.quota}` !== \"undefined\") {\n            let hash = bcrypt.hashSync(`${flags.passw}`, 10);\n            let body = new Object({\n                username: `${flags.newuser}`,\n                passw: `${flags.passw}`,\n                email: `${flags.email}`,\n                quota: `${flags.quota}`\n            });\n            await axios.post('https://localhost:8765/energy/api/Admin/users', body);\n        }\n        //modify user\n        else if (`${flags.moduser}` !== \"undefined\" && `${flags.passw}` !== \"undefined\" && `${flags.email}` !== \"undefined\" && `${flags.quota}` !== \"undefined\") {\n            let body = new Object({\n                username: `${flags.moduser}`,\n                passw: `${flags.passw}`,\n                email: `${flags.email}`,\n                quota: `${flags.quota}`\n            });\n            await axios.put('https://localhost:8765/energy/api/Admin/users/' + `${flags.moduser}`, body);\n        }\n        //get userstatus\n        else if (`${flags.userstatus}` !== \"undefined\") {\n            const data = await axios.get('https://localhost:8765/energy/api/Admin/users/' + `${flags.userstatus}`);\n            console.log(data.data);\n        }\n        //insert new data\n        else if (`${flags.newdata}` !== \"undefined\" && `${flags.source}` !== \"undefined\") {\n            var csv = require('csv-parser');\n            var FormData = require('form-data');\n            const form_data = new FormData();\n            var data = [];\n            form_data.append(\"file\", fs.createReadStream(`${flags.source}`));\n            form_data.pipe(csv()).on('data', function (row) { data.push(row); }).on('end', function () { console.log('Data Loaded'); });\n            let header = form_data.getHeaders();\n            const config = {\n                method: 'POST',\n                port: 8765,\n                headers: {\n                    \"x-observatory-auth\": token,\n                    header\n                },\n                maxContentLength: 524228890\n            };\n            return await axios.post('https://localhost:8765/energy/api/Admin/' + `${flags.newdata}`, form_data, config);\n        }\n        else\n            console.log(\"Unsuccesful\" + `${flags.newuser}`, `${flags.passw}`, `${flags.email}`, `${flags.quota}`);\n    }\n}\nexports.AdminCommand = AdminCommand;\nAdminCommand.flags = {\n    newuser: command_2.flags.string({ dependsOn: ['passw'], exclusive: ['newdata', 'userstatus', 'moduser'] }),\n    moduser: command_2.flags.string({ dependsOn: ['passw'], exclusive: ['newuser', 'newdata', 'userstatus'] }),\n    passw: command_2.flags.string({ dependsOn: ['email'] }),\n    email: command_2.flags.string({ dependsOn: ['quota'] }),\n    quota: command_2.flags.string(),\n    userstatus: command_2.flags.string({ exclusive: ['newdata', 'newuser', 'moduser'] }),\n    newdata: command_2.flags.string({ dependsOn: ['source'], exclusive: ['userstatus', 'newuser', 'moduser'] }),\n    source: command_2.flags.string()\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL2hvbWUvdmFuZ2VsaXMvVEwxOS0wNy9jbGktY2xpZW50L2VuZXJneS9lbmVyZ3lfZ3JvdXAwNy9zcmMvY29tbWFuZHMvQWRtaW4udHMiLCJzb3VyY2VzIjpbIi9ob21lL3ZhbmdlbGlzL1RMMTktMDcvY2xpLWNsaWVudC9lbmVyZ3kvZW5lcmd5X2dyb3VwMDcvc3JjL2NvbW1hbmRzL0FkbWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsbUNBQXdCO0FBQ3hCLHdCQUF3QjtBQUN4Qiw0Q0FBc0M7QUFFdEMsNENBQXFDO0FBQ3JDLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNqQyxJQUFJLEVBQUUsR0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDckIsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0FBQzlCLE1BQU0sS0FBSyxHQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUM3QixNQUFNLFdBQVcsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFBO0FBQ2pELEtBQUssQ0FBQyxRQUFRLENBQUMsVUFBVSxHQUFHLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFDLEVBQUUsRUFBRyxXQUFXLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUE7QUFDaEYsTUFBYSxZQUFhLFNBQVEsaUJBQU87SUFXdkMsS0FBSyxDQUFDLEdBQUc7UUFDUCxNQUFNLEVBQUMsS0FBSyxFQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUM1QyxJQUFJLEVBQUUsR0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckIsSUFBSSxHQUFHLEdBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ2hDLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMscUJBQXFCLEVBQUMsT0FBTyxDQUFDLENBQUM7UUFD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LENBQUM7SUFDekYsS0FBSyxFQUFFLGVBQUssQ0FBQyxNQUFNLENBQUMsRUFBQyxTQUFTLEVBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxDQUFDO0lBQzFDLEtBQUssRUFBRSxlQUFLLENBQUMsTUFBTSxDQUFDLEVBQUMsU0FBUyxFQUFDLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQztJQUMxQyxLQUFLLEVBQUUsZUFBSyxDQUFDLE1BQU0sRUFBRTtJQUNyQixVQUFVLEVBQUUsZUFBSyxDQUFDLE1BQU0sQ0FBQyxFQUFDLFNBQVMsRUFBQyxDQUFDLFNBQVMsRUFBQyxTQUFTLEVBQUMsU0FBUyxDQUFDLEVBQUMsQ0FBQztJQUNyRSxPQUFPLEVBQUUsZUFBSyxDQUFDLE1BQU0sQ0FBQyxFQUFDLFNBQVMsRUFBQyxDQUFDLFFBQVEsQ0FBQyxFQUFDLFNBQVMsRUFBQyxDQUFDLFlBQVksRUFBQyxTQUFTLEVBQUMsU0FBUyxDQUFDLEVBQUMsQ0FBQztJQUMxRixNQUFNLEVBQUUsZUFBSyxDQUFDLE1BQU0sRUFBRTtDQUN2QixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNsaSBmcm9tICdjbGktdXgnXG4vLyBqdXN0IHByb21wdCBmb3IgaW5wdXRcbmltcG9ydCB7Q29tbWFuZH0gZnJvbSAnQG9jbGlmL2NvbW1hbmQnXG5pbXBvcnQge2NyZWF0ZUNvbm5lY3Rpb259IGZyb20gXCJ0eXBlb3JtXCI7XG5pbXBvcnQge2ZsYWdzfSBmcm9tICAnQG9jbGlmL2NvbW1hbmQnXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcbnZhciBmcz1yZXF1aXJlKCdmcycpO1xuY29uc3QgaHR0cHMgPSByZXF1aXJlKCdodHRwcycpXG5jb25zdCBheGlvcz1yZXF1aXJlKCdheGlvcycpO1xuY29uc3QgY2xpZW50X2NlcnQgPSBmcy5yZWFkRmlsZVN5bmMoJ2NhLWNydC5wZW0nKVxuYXhpb3MuZGVmYXVsdHMuaHR0cHNBZ2VudCA9IG5ldyBodHRwcy5BZ2VudCh7Y2EgOiBjbGllbnRfY2VydCwga2VlcEFsaXZlOiB0cnVlfSlcbmV4cG9ydCBjbGFzcyBBZG1pbkNvbW1hbmQgZXh0ZW5kcyBDb21tYW5kIHtcbiAgc3RhdGljIGZsYWdzID0geyBcbiAgICBuZXd1c2VyOiBmbGFncy5zdHJpbmcoe2RlcGVuZHNPbjpbJ3Bhc3N3J10sZXhjbHVzaXZlOlsnbmV3ZGF0YScsJ3VzZXJzdGF0dXMnLCdtb2R1c2VyJ119KSxcbiAgICBtb2R1c2VyOiBmbGFncy5zdHJpbmcoe2RlcGVuZHNPbjpbJ3Bhc3N3J10sZXhjbHVzaXZlOlsnbmV3dXNlcicsJ25ld2RhdGEnLCd1c2Vyc3RhdHVzJ119KSxcbiAgICBwYXNzdzogZmxhZ3Muc3RyaW5nKHtkZXBlbmRzT246WydlbWFpbCddfSksXG4gICAgZW1haWw6IGZsYWdzLnN0cmluZyh7ZGVwZW5kc09uOlsncXVvdGEnXX0pLFxuICAgIHF1b3RhOiBmbGFncy5zdHJpbmcoKSxcbiAgICB1c2Vyc3RhdHVzOiBmbGFncy5zdHJpbmcoe2V4Y2x1c2l2ZTpbJ25ld2RhdGEnLCduZXd1c2VyJywnbW9kdXNlciddfSksXG4gICAgbmV3ZGF0YTogZmxhZ3Muc3RyaW5nKHtkZXBlbmRzT246Wydzb3VyY2UnXSxleGNsdXNpdmU6Wyd1c2Vyc3RhdHVzJywnbmV3dXNlcicsJ21vZHVzZXInXX0pLFxuICAgIHNvdXJjZTogZmxhZ3Muc3RyaW5nKClcbiAgfVxuICBhc3luYyBydW4oKSB7XG4gICAgY29uc3Qge2ZsYWdzfSA9IHRoaXMucGFyc2UoQWRtaW5Db21tYW5kKTsgXG5cdHZhciBmcz1yZXF1aXJlKCdmcycpO1xuXHR2YXIgand0PXJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuXHR2YXIgdG9rZW4gPSBmcy5yZWFkRmlsZVN5bmMoJ3NvZnRlbmcxOWJBUEkudG9rZW4nLCd1dGYtOCcpO1xuXHRheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1PQlNFUlZBVE9SWS1BVVRIJ109dG9rZW47XG5cdGF3YWl0IGNsaS5hbnlrZXkoKTtcblx0Ly9jcmVhdGUgbmV3IHVzZXJcblx0aWYgKGAke2ZsYWdzLm5ld3VzZXJ9YCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBgJHtmbGFncy5wYXNzd31gICE9PSBcInVuZGVmaW5lZFwiICYmIGAke2ZsYWdzLmVtYWlsfWAgIT09IFwidW5kZWZpbmVkXCIgJiYgYCR7ZmxhZ3MucXVvdGF9YCAhPT0gXCJ1bmRlZmluZWRcIiApe1xuXHRcdFx0bGV0IGhhc2ggPSBiY3J5cHQuaGFzaFN5bmMoYCR7ZmxhZ3MucGFzc3d9YCwxMCk7XG5cdFx0XHRsZXQgYm9keSA9IG5ldyBPYmplY3QgKHtcblx0XHRcdFx0dXNlcm5hbWU6IGAke2ZsYWdzLm5ld3VzZXJ9YCxcblx0XHRcdFx0cGFzc3c6IGAke2ZsYWdzLnBhc3N3fWAsXG5cdFx0XHRcdGVtYWlsOiBgJHtmbGFncy5lbWFpbH1gLFxuXHRcdFx0XHRxdW90YTogYCR7ZmxhZ3MucXVvdGF9YCBcblx0XHRcdH0pXG5cdFx0XHRhd2FpdCBheGlvcy5wb3N0KCdodHRwczovL2xvY2FsaG9zdDo4NzY1L2VuZXJneS9hcGkvQWRtaW4vdXNlcnMnLGJvZHkpO1xuXHRcdFx0XHRcblx0fVxuXHRcblx0Ly9tb2RpZnkgdXNlclxuXHRlbHNlIGlmIChgJHtmbGFncy5tb2R1c2VyfWAgIT09IFwidW5kZWZpbmVkXCIgJiYgYCR7ZmxhZ3MucGFzc3d9YCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBgJHtmbGFncy5lbWFpbH1gICE9PSBcInVuZGVmaW5lZFwiICYmIGAke2ZsYWdzLnF1b3RhfWAgIT09IFwidW5kZWZpbmVkXCIgKXtcblx0XHRsZXQgYm9keSA9IG5ldyBPYmplY3QgKHtcblx0XHRcdFx0dXNlcm5hbWU6IGAke2ZsYWdzLm1vZHVzZXJ9YCxcblx0XHRcdFx0cGFzc3c6IGAke2ZsYWdzLnBhc3N3fWAsXG5cdFx0XHRcdGVtYWlsOiBgJHtmbGFncy5lbWFpbH1gLFxuXHRcdFx0XHRxdW90YTogYCR7ZmxhZ3MucXVvdGF9YCBcblx0XHR9KVxuXHRcdGF3YWl0IGF4aW9zLnB1dCgnaHR0cHM6Ly9sb2NhbGhvc3Q6ODc2NS9lbmVyZ3kvYXBpL0FkbWluL3VzZXJzLycgK2Ake2ZsYWdzLm1vZHVzZXJ9YCxib2R5KTtcblx0fVxuXHRcblx0XG5cdC8vZ2V0IHVzZXJzdGF0dXNcblx0ZWxzZSBpZiAoYCR7ZmxhZ3MudXNlcnN0YXR1c31gICE9PSBcInVuZGVmaW5lZFwiKXtcblx0XHRjb25zdCBkYXRhPWF3YWl0IGF4aW9zLmdldCgnaHR0cHM6Ly9sb2NhbGhvc3Q6ODc2NS9lbmVyZ3kvYXBpL0FkbWluL3VzZXJzLycgK2Ake2ZsYWdzLnVzZXJzdGF0dXN9YCk7XHRcblx0XHRjb25zb2xlLmxvZyhkYXRhLmRhdGEpO1xuXHR9XG5cblx0XG5cdC8vaW5zZXJ0IG5ldyBkYXRhXG5cdGVsc2UgaWYgKGAke2ZsYWdzLm5ld2RhdGF9YCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBgJHtmbGFncy5zb3VyY2V9YCAhPT0gXCJ1bmRlZmluZWRcIiApe1xuXHRcdHZhciBjc3Y9cmVxdWlyZSgnY3N2LXBhcnNlcicpO1xuXHRcdHZhciBGb3JtRGF0YT1yZXF1aXJlKCdmb3JtLWRhdGEnKTtcblx0XHRjb25zdCBmb3JtX2RhdGEgPSBuZXcgRm9ybURhdGEoKTtcblx0XHR2YXIgZGF0YSA9IFtdO1xuXHRcdGZvcm1fZGF0YS5hcHBlbmQoXCJmaWxlXCIsIGZzLmNyZWF0ZVJlYWRTdHJlYW0oYCR7ZmxhZ3Muc291cmNlfWApKTtcblx0XHRmb3JtX2RhdGEucGlwZShjc3YoKSkub24oJ2RhdGEnLGZ1bmN0aW9uKHJvdzphbnkpeyBkYXRhLnB1c2gocm93KSB9KS5vbignZW5kJyxmdW5jdGlvbigpe2NvbnNvbGUubG9nKCdEYXRhIExvYWRlZCcpfSk7XG5cdFx0bGV0IGhlYWRlciA9IGZvcm1fZGF0YS5nZXRIZWFkZXJzKCk7XG5cdFx0Y29uc3QgY29uZmlnID0ge1xuXHRcdFx0bWV0aG9kOiAnUE9TVCcsXG5cdFx0XHRwb3J0Ojg3NjUsXG5cdFx0XHRoZWFkZXJzOiB7XG5cdFx0XHRcdFwieC1vYnNlcnZhdG9yeS1hdXRoXCI6dG9rZW4sXG5cdFx0XHRcdGhlYWRlclxuXHRcdFx0fSxcbiBcdFx0XHRtYXhDb250ZW50TGVuZ3RoOjUyNDIyODg5MFxuXHRcdH07XG5cblx0XHRyZXR1cm4gYXdhaXQgYXhpb3MucG9zdCgnaHR0cHM6Ly9sb2NhbGhvc3Q6ODc2NS9lbmVyZ3kvYXBpL0FkbWluLycgKyBgJHtmbGFncy5uZXdkYXRhfWAsIGZvcm1fZGF0YSxjb25maWcpO1xuXHR9XG5cdGVsc2UgY29uc29sZS5sb2coXCJVbnN1Y2Nlc2Z1bFwiICsgYCR7ZmxhZ3MubmV3dXNlcn1gLGAke2ZsYWdzLnBhc3N3fWAsYCR7ZmxhZ3MuZW1haWx9YCxgJHtmbGFncy5xdW90YX1gKTsgIFxuICB9XG59XG5cblxuXG5cblxuXG4iXX0="]}